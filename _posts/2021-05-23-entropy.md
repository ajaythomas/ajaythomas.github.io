---
title: One Time Passcodes & Entropy
categories:
- Tech
feature_image: "https://picsum.photos/2560/600?image=872"
---

You’re logging into your bank account and after you enter your password, you’re prompted to enter a code that you just received on your phone.


This Multi Factor Authentication (MFA) uses a second factor like your phone to further verify your identity while you log in.

But, have you paid much attention to what this phone code is? Introducing one time passcodes and entropy...

### One Time Passcodes

One time passcodes or OTPs are randomly generated numbers that expire after a set time. OTPs are used as an additional verifying factor on top of your existing passwords. They can appear via sms, phone call, email or an authenticator app like Google Authenticator, Authy or Okta Verify.

These codes should be at least 6 characters in length as per the National Institute of Standards & Technology (NIST) digital identity guidelines. Codes can also be entirely numeric.

### Entropy

No, we’re not talking about chemical thermodynamics. In cyber security, entropy measures the number of possible choices when generating a random number. So, a 6 digit passcode has 10<sup>6</sup> (1 million) possibilities ranging from “000000” to “999999”.
The higher the possibilities, the higher the entropy. So, a 6-digit passcode has a higher entropy than a 4-digit passcode, but a lower entropy than an 8-digit passcode.

When you express 10<sup>6</sup> in binary, 20 bits are required,
Log<sub>2</sub> 1000000 = 19.9315
So, you can also say a 6 digit passcode has 20 bits of entropy.

NIST also requires the verifying party to have some rate limiting in place if the passcode is less than 64 bits (convert to normal numbers) of entropy. Rate limiting is the process by which the verifying party (any app that you’re trying to log into) introduces measures to prevent attackers from trying every possibility repeatedly with no consequences.
The verifying party could try: 
letting passcodes to be entered once every 30 seconds. This adds some delay and could thwart attackers.
Locking accounts after x failed attempts.


How are passcodes generated? 


Random number generation (RNG) algorithms are at the heart of generating these passcodes. These are not truly random because they are generated by a starting value called a seed. 
When you see a random number generated by this seed, you cannot guess the next or previous number in the sequence. However, if you know the seed, then the integrity of the RNG system is lost since you can now guess every past and future random number generated by it.
Hence, they are called pseudo-random number generators (PRNG) or deterministic random bit generator (DRBG)

Pseudo random number generators are primarily used for generating passcodes. Since the seed is maintained by the passcode generator and should be kept securely.

So, the next time you see passcodes delivered to your phone, you can relive the story of entropy and random number generations until that passcode expires.

Here are some NIST publications covering this in more technical detail:

* [Passcodes & Entropy](https://pages.nist.gov/800-63-3/sp800-63b.html#appA)

* [Random Number Generators recommendations](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf)


Liked this post? Share them lest others should find this useful.

